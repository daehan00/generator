SYSTEM_PROMPT = """당신은 보고서를 작성하는 전문가입니다. 정보 유출 진단 보고서를 작성하는 것이 목표입니다.
보고서를 작성할 시에 준수해야 할 사항은 다음과 같습니다.
1. 어조는 ~습니다. ~입니다. 등 전문 분석 보고서 형태에 어울리도록 정중하게 작성
2. 마크다운 형식으로 작성
3. 사실관계를 중심으로 작성. 추측 또는 주관은 최소화하여 작성
4. 필요한 경우를 제외하고는 예시를 따라 작성

[유의사항]
- datetime 형태로 작성된 시간 값들을 모두 utc기준시이므로 한국 시간으로 변환해 사용할 것
- # 기호를 사용하여 소제목을 표현하지 말 것. 소제목은 단독 행으로 작성하고 볼드처리한다"""

# 분석 목적
PROMPT_0 = """본 분석의 목적은 대상 PC 로부터 사내 주요 기밀정보(고객정보, 사내 데이터 등)의 유출 정황을 파악하는 것입니다."""

# 데이터 수집
PROMPT_1 = """대상 기기(PC)에 대한 정보만(PC_ID -> MAC 주소, PC이름, 운영체제, IP주소) 먼저 표 형태로 표시하고, 수집된 아티팩트 범위에 대해서 간단하게 설명해주세요. 아래 예시를 참고하세요.
표는 항목명을 1행에, 내용을 2행에 넣고 첫번째 열은 제거합니다.
사용자명과 팀명, 직급 등을 포함해 주세요. 아래의 job_info의 내용에 따라 작성하세요.
데이터 수집 일정은 이후에 따로 작성하므로 수집 일정은 작성해서는 안됩니다.

{job_info}

[예시]
본 분석은 퇴사 예정자인 김민재 대리의 업무용 Windows PC 에 대하여 정보를 수집하였으며, 행위에 따라 기록되는 주요 아티팩트 데이터를 확보하였습니다. 대상 기기 정보는 다음과 같습니다.
| MAC 주소 | PC 이름 | 운영체제 | IP 주소 |
|---|---|---|---|
| 00-0C-29-EB-B3-7B | DESKTOP-4L4O6MI | Windows 11 Version 24H2 | 192.168.74.135 |

수집된 아티팩트는 브라우저 사용 내역, USB 연결 기록, 프로그램 실행 기록(프리패치), 파일 실행 및 삭제 흔적, 메신저 이용 내역 등으로, 이를 종합적으로 분석하여 사용자의 활동을 확인할 수 있습니다."""

# 분석 일정
PROMPT_2 = """job_info의 정보에 따라 분석 일정을 작성하세요. 소제목 없이 본문만 작성하세요.

{job_info}

[예시]
분석은 자동화 시스템을 통해 이루어졌으며, 총 30 분이 소요되었습니다.
분석 일시: 2025 년 9 월 18 일 목요일 오후 13:00 – 13:30"""

# 분석 방법 및 절차
PROMPT_3 = """본 분석은 자동화된 시스템을 통해 아래 단계의 절차로 수행되었으며, 이를 통해 신속하고 일관된 결과를 도출하였습니다.
**1) 데이터 수집**
- 분석 시스템이 대상 PC에 접근하여 [1.2 데이터 수집]에 명시된 브라우저, 외부 저장 매체, 메신저 등 각 영역의 디지털 아티팩트 원본 데이터를 일괄 수집합니다.
**2) 데이터 전처리 및 필터링**
- 수집된 로그, 데이터베이스, 시스템 파일 등 비정형 데이터를 분석 가능한 정형 데이터로 변환합니다.
- 이후, 분석 목적과 관련 없는 시스템의 기본 동작 기록(쓰레기 데이터)을 제거하여 사용자의 유의미한 행위 데이터만을 추출합니다.
**3) 데이터 분석 AI 에이전트 분석**
- 처리된 행위 데이터를 기반으로, 거대 언어 모델(LLM)이 적용되어 스스로 사고하고 분석하는 AI 에이전트가 작업을 수행합니다.
- 에이전트는 주어진 목표를 달성하기 위해 데이터를 자유롭게 탐색하고 그 사이의 연관성을 종합하여 시나리오를 재구성하고, 그 결과를 보고서로 생성합니다.
"""

# 분석의 한계
PROMPT_4 = """본 분석은 정보유출 징후가 의심되는 사용자 PC 에 남아 있는 아티팩트에 국한하여 수행되었습니다.
- 외부 저장매체 자체, 네트워크 기록, 서버 로그 등은 분석 범위에 포함되지 않았습니다.
- 일부 결과는 정황 및 시간축 기반의 합리적 추정으로, 객관적 증거력이 부족할 수 있습니다.
- 본 보고서의 내용은 법적 판단을 대신하지 않으며, 중요한 의사결정이나 법적 조치 전에는 추가 검증 및 전문기관의 재검토를 권장합니다."""

# 분석 요약
PROMPT_5 = """분석 요약을 작성합니다.
분석 결과를 확인하고, 행위별로 구분하여 결과를 저장합니다. 소제목은 작성하지 않습니다.
먼저 행위별로 1~2문장 이내로 자연어 요약을 작성합니다.
이후 행위 구분 / 일시 / 행위 내용 / 관련 증거 순서로 표를 작성합니다. 행의 데이터는 같은 행위, 비슷한 시간이면 하나로 묶어서 표현합니다.
**분석 결과 정보 유출로 의심되는 데이터가 없으면 관련 데이터가 발견되지 않았다고 작성하세요.**
첫 시작으로 **분석 요약** 등 목차를 집어넣지 말고 본문으로 시작합니다.

[분석 결과]
{context}

[예시]
- 취득 행위: 2025 년 9 월 15 일, 구글 클라우드 서비스에 접속하여 기밀로 분류된 고객 정보 파일을 로컬 PC 로 다운로드했습니다.
- 유출 행위: 파일 다운로드 직후, 개인 소유로 추정되는 USB 저장 장치를 연결하여 파일을 복사했으며, 유사한 시점에 카카오톡 메신저를 통해 파일을 전송한 흔적이 확인되었습니다.
- 증거 인멸 행위: 유출에 사용된 파일을 휴지통을 통해 삭제하고, 특정 시간대의 브라우저 접속 기록을 삭제하여 행위를 은닉하려는 시도가 있었습니다.

| **구분** | **일시 (KST)** | **행위 내용** | **관련 증거** |\n|---|---|---|---|\n| **취득 행위** | 2025-09-15 14:22~23 | 구글 드라이브 접속 후 기밀 파일 다운로드 | Chrome History DB, Download Logs, LNK Files |\n| **유출 행위** | 2025-09-15 14:25 | USB 저장 장치(SanDisk Ultra Flair) 연결 후 파일 복사 가능성 | Registry (USBSTOR), setupapi.dev.log |\n| **유출 행위** | 2025-09-15 14:30 | 카카오톡 PC 버전을 통해 동일 파일 전송 정황 | KakaoTalk Cache Data |\n| **증거 인멸** | 2025-09-15 14:40~41 | 다운로드 파일 삭제 및 Chrome 기록 삭제, SDelete 실행 흔적 | \\$Recycle.Bin Metadata, MFT Entry, Chrome Cache/Session, Prefetch Files |"""

# 취득 행위
PROMPT_6 = """분석 결과에 근거하여 취득 행위에 대한 상세 내용을 작성합니다.
취득 행위란 온라인을 통하거나 클라우드 등의 저장소에서 데이터를 로컬로 가져오는 작업을 의미합니다.
**분석 결과 취득 행위가 없으면 관련 데이터가 발견되지 않았다고 작성하세요.**
첫 시작으로 **취득 행위** 등 목차를 집어넣지 말고 본문으로 시작합니다.
[분석 결과]
{context}

[예시]
분석 대상자는 개인 구글 클라우드 계정을 통해 회사 내부 정보를 취득한 것으로 확인되었습니다.

**상세 분석 결과**:
- 2025년 9월 15일 14:22, Chrome 브라우저를 통해 구글 드라이브(drive.google.com)에 접속한 기록이 확인되었습니다.
- 브라우저 다운로드 내역 분석 결과, 같은 날 **14:23**에 **'[대외비]_고객정보_2025_3Q.xlsx'** (크기: 15.4MB) 파일이 C:\\Users\\minjae.kim\\Downloads 경로에 저장된 사실을 확인했습니다.
- 바탕화면 및 최근 사용 항목의 LNK 파일 분석 결과, 해당 파일이 다운로드 직후 최소 1회 이상 실행되었음을 나타내는 흔적을 발견했습니다.
**관련 증거**:
- Chrome History DB: drive.google.com 접속 기록
- Chrome Download Logs: [대외비]_고객정보_2025_3Q.xlsx 다운로드 로그
- LNK Files: [대외비]_고객정보_2025_3Q.xlsx.lnk 파일 메타데이터"""

# 유출 행위
PROMPT_7 = """분석 결과에 근거하여 유출 행위에 대한 상세 내용을 작성합니다.
여기서 유출 행위란 유출과 직접적으로 관련된 내용을 말합니다.
**분석 결과 유출 행위가 없으면 관련 데이터가 발견되지 않았다고 작성하세요.**
첫 시작으로 **유출 행위** 등 목차를 집어넣지 말고 본문으로 시작합니다.
[분석 결과]
{context}

[예시]
취득한 기밀 파일은 **USB 저장 장치**와 **개인 메신저**라는 두 가지 경로를 통해 외부로 유출된 정황이 식별되었습니다.
**경로 1: USB 저장 장치를 통한 유출**
- 레지스트리(USBSTOR) 및 시스템 로그 분석 결과, 파일 다운로드 직후인 2025년 9월 15일 14:25 에 'SanDisk Ultra Flair' 모델의 USB 장치(S/N:AA0123456789BEEF)가 PC 에 연결된 기록을 확인했습니다.
- 해당 USB 는 과거에도 여러 차례 사용된 이력이 있으며, 파일 취득 시점과 저장 매체 연결 시점이 매우 인접하여 데이터 복사를 위한 목적으로 사용되었을 가능성이 높습니다.
**경로 2: 메신저를 통한 유출**
- 카카오톡 PC 버전의 아티팩트 분석 결과, 2025 년 9 월 15 일 14:30 경 외부 대화 상대에게 파일이 전송된 기록을 확인했습니다.
- 대화 내용은 암호화되어 직접적인 확인은 불가했으나, 메신저 캐시 폴더에서 유출된 파일과 동일한 이름 및 크기(15.4MB)를 가진 파일의 조각(Fragment)이 발견되었습니다. 이는 파일 전송 행위의 강력한 증거로 볼 수 있습니다.
**관련 증거:**
- Registry (USBSTOR): SanDisk Ultra Flair USB 연결 기록
- setupapi.dev.log: 장치 연결 이벤트 로그
- KakaoTalk Cache Data: [대외비]_고객정보_2025_3Q.xlsx 파일 조각 데이터"""

# 증거 인멸 행위
PROMPT_8 = """분석 결과에 근거하여 증거 인멸 행위에 대한 상세 내용을 작성합니다.
**분석 결과 증거 인멸 행위가 없으면 관련 데이터가 발견되지 않았다고 작성하세요.**
첫 시작으로 **증거 인멸 행위** 등 목차를 집어넣지 말고 본문으로 시작합니다.
[분석 결과]
{context}

[예시]
분석 대상자는 정보 유출 후 자신의 행적을 숨기기 위해 관련 디지털 증거를 삭제하려 한 것으로 보입니다.
**상세 분석 결과:**
- 파일 삭제: Downloads 폴더에 있던 '[대외비]_고객정보_2025_3Q.xlsx' 파일은 현재 존재하지 않으며, 휴지통($Recycle.Bin) 분석 결과 2025년 9월 15일 14:40에 해당 파일이 삭제되었음을 확인했습니다.
- 기록 삭제: Chrome 브라우저의 접속 기록 중, 유출 행위가 발생한 2025년 9월 15일 14:20 ~ 14:30 사이의 기록이 선택적으로 삭제되었습니다.
- 복구 가능성: MFT(Master File Table) 분석 결과, 삭제된 파일의 메타데이터가 시스템에 그대로 남아있어 원본 파일의 복구가 가능한 상태입니다. 또한, 브라우저 캐시 및 세션 파일에는 삭제된 기록의 일부가 잔존하여 구글 드라이브 접속 사실을 재확인할 수 있었습니다.
- Prefetch 분석 결과, 보안 삭제 프로그램인 SDelete64.exe 가 14:41 에 실행된 흔적이 발견되어, 단순 삭제를 넘어 영구 삭제를 시도했을 가능성도 존재합니다.
**관련 증거:**
- $Recycle.Bin Metadata: 파일 삭제 시간 및 원본 경로 정보
- MFT Entry: 삭제된 파일의 메타데이터
- Chrome Cache/Session Files: 삭제된 시간대의 웹 접속 흔적
- Prefetch Files: SDelete64.exe.pf 실행 기록"""

# 기타 의심 행위
PROMPT_9 = """분석 결과에 근거하여 기타 의심 행위에 대한 상세 내용을 작성합니다.
분석 결과에 기타 의심 행위가 없으면 None 이라는 문자열을 반환합니다.
첫 시작으로 **기타 의심 행위** 등 목차를 집어넣지 말고 본문으로 시작합니다.

[분석 결과]
{context}

[예시]
분석 대상자는 이직을 준비했던 것으로 보입니다.
**상세 분석 결과:**
- 구인구직 사이트 접속: 2025년 9월 10일부터 15일까지 Chrome 브라우저를 통해 사람인(saramin.co.kr), 잡코리아(jobkorea.co.kr), 링크드인(linkedin.com) 등 구인구직 사이트에 반복적으로 접속한 기록이 확인되었습니다.
- 이력서 관련 활동: 2025년 9월 12일, 온라인 이력서 작성 도구(resume.co.kr)에 접속하여 약 2시간 동안 세션이 유지된 기록이 발견되었습니다.
- 경쟁사 정보 탐색: 2025년 9월 13일과 14일, 동종 업계의 주요 경쟁사 홈페이지 및 채용 공고 페이지에 대한 접속 기록이 다수 확인되었습니다.
- 포트폴리오 준비: Downloads 폴더 내에 'Portfolio_2025.zip', '자기소개서_최종.docx' 등 이직 준비와 관련된 파일명의 다운로드 기록이 발견되었습니다.
**관련 증거:**
- Chrome History DB: 구인구직 사이트 반복 접속 기록
- Chrome Download Logs: 이력서 템플릿 및 포트폴리오 파일 다운로드 기록
- LNK Files: 이직 관련 문서 파일 실행 흔적"""

# 결론 - 확인된 사실
PROMPT_10 = """분석 결과에 근거하여 확인된 사실을 정리하여 나열합니다.
**소제목은 작성하지 않습니다.**

[분석 결과]
{context}

[예시]
본 분석을 통해 객관적인 디지털 증거로 확인된 사실은 다음과 같습니다.
- (사실 1) 2025년 9월 15일 14시 23분, 분석 대상 PC 에서 구글 드라이브를 통해 '[대외비]_고객정보_2025_3Q.xlsx' (15.4MB) 파일이 다운로드되었습니다.
- (사실 2) 파일 다운로드 2분 후인 14시 25분, 외부 저장 장치 'SanDisk Ultra Flair' 모델이 PC 에 연결되었습니다.
- (사실 3) 14시 30분경, 카카오톡 메신저를 통해 상기 파일과 동일한 크기와 이름의 파일이 전송된 흔적이 발견되었습니다.
- (사실 4) 14시 40분, 다운로드되었던 원본 파일이 삭제되었으며, 관련 시간대의 웹 브라우저 접속 기록 또한 삭제되었습니다.
- (사실 5) 14시 41분, 데이터 영구 삭제 유틸리티(SDelete64.exe)가 실행된 기록이 확인되었습니다."""

# 결론 - 재구성, 종합 의견
PROMPT_11 = """분석 결과와 예상 시나리오를 바탕으로 재구성 및 종합 의견을 작성합니다.
**소제목은 작성하지 않습니다.**

[분석 결과]
{context}

[시나리오 정보]
{scenario}

[예시]
확인된 디지털 증거를 시간순으로 재구성하면, 정보 유출로 볼 수 있는 일련의 행위가 다음과 같이 식별됩니다.
2025 년 9 월 15 일, 먼저 특정 기밀 파일이 PC 로 다운로드되었습니다(사실 1). 그 직후, 외부 저장 매체 연결(사실 2)과 메신저를 통한 파일 전송 흔적(사실 3)이라는 두 가지 잠재적 데이터 유출 경로가 동시에 확인되었습니다. 자료 취득부터 외부 장치 연결, 메신저 사용까지의 행위가 수 분 이내에 집중적으로 발생했다는 점은 각 행위 간의 연관성이 높음을 시사합니다.
이후, 선행된 작업의 흔적을 제거하기 위한 행위가 이어졌습니다. 다운로드된 원본 파일과 관련 웹 접속 기록이 삭제되었고(사실 4), 일반적인 삭제가 아닌 데이터 영구 삭제 전문 도구가 사용된 사실(사실 5)이 확인되었습니다. 이는 단순히 데이터를 정리하는 목적을 넘어, 디지털 증거의 복구를 의도적으로 어렵게 만들려는 시도로 해석될 수 있습니다.
결론적으로, 이러한 일련의 행위는 우발적인 실수나 일반적인 업무 행위가 아닌 의도적인 정보 유출 행위로 의심됩니다."""